<!DOCTYPE html>
<html>
<head>
  <title>Test Undo/Redo</title>
</head>
<body>
  <h1>Test Undo/Redo</h1>
  <div id="app">
    <p>Value: <span id="value">0</span></p>
    <button id="increment">Increment</button>
    <button id="undo">Undo</button>
    <button id="redo">Redo</button>
    <p>Can Undo: <span id="canUndo">false</span></p>
    <p>Can Redo: <span id="canRedo">false</span></p>
    <p>History: <span id="history">[]</span></p>
  </div>

  <script type="module">
    import { createReactor } from './packages/reactor/dist/index.js';
    import { undoRedo } from './packages/reactor/dist/plugins.js';

    const counter = createReactor(
      { value: 0 },
      {
        name: 'test-counter',
        plugins: [undoRedo({ limit: 10 })]
      }
    );

    function render() {
      document.getElementById('value').textContent = counter.state.value;
      document.getElementById('canUndo').textContent = counter.canUndo();
      document.getElementById('canRedo').textContent = counter.canRedo();
      document.getElementById('history').textContent = JSON.stringify(counter.getHistory());
    }

    document.getElementById('increment').addEventListener('click', () => {
      console.log('Before increment:', counter.state.value);
      counter.update(state => {
        state.value++;
      }, 'increment');
      console.log('After increment:', counter.state.value);
      render();
    });

    document.getElementById('undo').addEventListener('click', () => {
      console.log('Before undo:', counter.state.value);
      counter.undo();
      console.log('After undo:', counter.state.value);
      render();
    });

    document.getElementById('redo').addEventListener('click', () => {
      console.log('Before redo:', counter.state.value);
      counter.redo();
      console.log('After redo:', counter.state.value);
      render();
    });

    render();
  </script>
</body>
</html>
